(this["webpackJsonponline-chating"]=this["webpackJsonponline-chating"]||[]).push([[0],{36:function(e,t,a){e.exports=a(64)},41:function(e,t,a){},42:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(25),o=a.n(r),i=(a(41),a(42),a(16)),s=a(4),u=a(14),l=a(5),m=a(8),d=a.n(m),p=a(17),f=a(10),h=a.n(f),E=(a(10).auth,"USER_LOGIN"),b="USER_LOGOUT",g="GET_REALTIME_USERS",v="GET_REALTIME_MSGES",O=a(6),j=(a(58),function(e){var t=Object(l.c)((function(e){return e.auth})),a=Object(l.b)();return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"leftMenu"},c.a.createElement("div",{className:"logo"},"Web Messenger"),t.isAuthenticated?null:c.a.createElement("ul",{className:"loginSignUpMenu"},c.a.createElement("li",null,c.a.createElement(i.c,{to:"/login"},"Login")),c.a.createElement("li",null,c.a.createElement(i.c,{to:"/signup"},"sign-up")))),c.a.createElement("div",{className:"greatings"},t.isAuthenticated?"Hello ".concat(t.firstName," ").concat(t.lastName):""),t.isAuthenticated?c.a.createElement("ul",{className:"rightMenu"},c.a.createElement(i.b,{to:"#",onClick:function(){var e;a((e=t.uid,function(){var t=Object(p.a)(d.a.mark((function t(a){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"".concat(b,"_REQUEST")}),Object(f.firestore)().collection("users").doc(e).update({isOnline:!1}).then((function(){Object(f.auth)().signOut().then((function(){localStorage.clear(),a({type:"".concat(b,"_SUCCESS")})})).catch((function(){a({type:"".concat(b,"_FAILIER"),payload:{error:"cannot loout"}})}))})).catch((function(e){console.log("error")}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}},"Logout")):"")}),S=function(e){return c.a.createElement("div",null,c.a.createElement(j,null),e.children)},y=(a(60),function(e){var t=e.user,a=e.onClick;return c.a.createElement("div",{onClick:function(){return a(t)},className:"displayName"},c.a.createElement("div",{className:"displayPic"},c.a.createElement("img",{src:"https://i.pinimg.com/originals/be/ac/96/beac96b8e13d2198fd4bb1d5ef56cdcf.jpg",alt:""})),c.a.createElement("div",{style:{margin:"0 10px",display:"flex",justifyContent:"space-between",flex:"1"}},c.a.createElement("span",{style:{fontWeight:500,fontSize:"12px",textTransform:"capitalize"}},t.firstName," ",t.lastName),c.a.createElement("span",{className:t.isOnline?"onlineStatus":"onlineStatus off"})))}),N=function(e){var t,a=Object(l.b)(),r=Object(l.c)((function(e){return e.auth})),o=Object(l.c)((function(e){return e.user})),i=Object(n.useState)(!1),s=Object(u.a)(i,2),m=s[0],h=s[1],E=Object(n.useState)(""),b=Object(u.a)(E,2),j=b[0],N=b[1],_=Object(n.useState)(""),w=Object(u.a)(_,2),C=w[0],A=w[1],I=Object(n.useState)(""),U=Object(u.a)(I,2),k=U[0],R=U[1];Object(n.useEffect)((function(){var e;t=a((e=r.uid,function(){var t=Object(p.a)(d.a.mark((function t(a){var n,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"".concat(g,"_REQUEST")}),n=Object(f.firestore)(),c=n.collection("users").onSnapshot((function(t){var n=[];t.forEach((function(t){t.data().uid!==e&&n.push(t.data())})),a({type:"".concat(g,"_SUCCESS"),payload:{users:n}})})),t.abrupt("return",c);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(e){return e})).catch((function(e){console.log(e)}))}),[]),Object(n.useEffect)((function(){return function(){t.then((function(e){return e()})).catch((function(e){return console.log(e)}))}}),[]);var x=function(e){h(!0),N("".concat(e.firstName," ").concat(e.lastName)),R(e.uid),a(function(e){return function(){var t=Object(p.a)(d.a.mark((function t(a){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(f.firestore)().collection("conversation").where("user_uid_1","in",[e.uid_1,e.uid_2]).orderBy("createdAt","asc").onSnapshot((function(t){var n=[];t.forEach((function(t){(t.data().user_uid_1==e.uid_1&&t.data().user_uid_2==e.uid_2||t.data().user_uid_1==e.uid_2&&t.data().user_uid_2==e.uid_1)&&n.push(t.data()),n.length>0?a({type:v,payload:{conversations:n}}):a({type:"".concat(v,"_FAILIER"),payload:{conversations:[]}})})),console.log(n)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({uid_1:r.uid,uid_2:e.uid}))};return c.a.createElement(S,null,c.a.createElement("section",{className:"container"},c.a.createElement("div",{className:"listOfUsers"},o.users.length>0?o.users.map((function(e){return c.a.createElement(y,{onClick:x,key:e.uid,user:e})})):null),c.a.createElement("div",{className:"chatArea"},c.a.createElement("div",{className:"chatHeader"},m?j:""),c.a.createElement("div",{className:"messageSections"},m?o.conversations.map((function(e){return c.a.createElement("div",{style:{textAlign:e.user_uid_1==r.uid?"right":"left"}},c.a.createElement("p",{className:"messageStyle"}," ",e.message))})):null),c.a.createElement("div",{className:"chatControls"},c.a.createElement("input",{type:"text",value:C,onChange:function(e){return A(e.target.value)},className:"textType",placeholder:"Type message here"}),c.a.createElement("button",{onClick:function(e){var t={user_uid_1:r.uid,user_uid_2:k,message:C};a(function(e){return function(){var t=Object(p.a)(d.a.mark((function t(a){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(f.firestore)().collection("conversation").add(Object(O.a)(Object(O.a)({},e),{},{isView:!1,createdAt:new Date})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)).then((function(){A("")})),console.log(t)}},"Send")))))},_=(a(61),function(e){return c.a.createElement("div",{className:"card"},e.children)}),w=(a(62),function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(""),m=Object(u.a)(i,2),h=m[0],b=m[1],g=Object(l.b)();return!0===Object(l.c)((function(e){return e.auth})).isAuthenticated?c.a.createElement(s.a,{to:"/"}):c.a.createElement(S,null,c.a.createElement("div",{className:"loginContainer"},c.a.createElement(_,null,c.a.createElement("form",{onSubmit:function(e){var t;(e.preventDefault(),""!==r)?""!==h?g((t={email:r,password:h},function(){var e=Object(p.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a({type:"".concat(E,"_REQUEST")}),Object(f.auth)().signInWithEmailAndPassword(t.email,t.password).then((function(e){Object(f.firestore)().collection("users").doc(e.user.uid).update({isOnline:!0}).then((function(){var n=e.user.displayName.split(" "),c={firstName:n[0],lastName:n[1],email:t.email,uid:e.user.uid};localStorage.setItem("user",JSON.stringify(c)),a({type:"".concat(E,"_SUCCESS"),payload:{user:c}})})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e),a({type:"".concat(E,"_FAILIER"),payload:{error:e}})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):alert("passwod cannot be empty"):alert("username cannot be empty")},className:"loginForm"},c.a.createElement("div",{className:"formHeader"},"log into account"),c.a.createElement("div",{className:"inputs"},c.a.createElement("input",{className:"inputContainer",value:r,onChange:function(e){return o(e.target.value)},placeholder:"User Name"}),c.a.createElement("input",{className:"inputContainer",value:h,onChange:function(e){return b(e.target.value)},placeholder:"Password"})),c.a.createElement("div",{className:"loginBtn"},c.a.createElement("button",null,"login"))))))}),C=(a(63),function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(""),m=Object(u.a)(i,2),h=m[0],b=m[1],g=Object(n.useState)(""),v=Object(u.a)(g,2),O=v[0],j=v[1],y=Object(n.useState)(""),N=Object(u.a)(y,2),w=N[0],C=N[1],A=Object(l.b)();return!0===Object(l.c)((function(e){return e.auth})).isAuthenticated?c.a.createElement(s.a,{to:"/"}):c.a.createElement(S,null,c.a.createElement("div",{className:"signUpContainer"},c.a.createElement(_,null,c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),A(function(e){return function(){var t=Object(p.a)(d.a.mark((function t(a){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"".concat(E,"_REQUEST")}),n=Object(f.firestore)(),Object(f.auth)().createUserWithEmailAndPassword(e.email,e.password).then((function(t){console.log(t);var c=Object(f.auth)().currentUser,r="".concat(e.firstName," ").concat(e.lastName);c.updateProfile({displayName:r}).then((function(){n.collection("users").doc(t.user.uid).set({firstName:e.firstName,lastName:e.lastName,uid:t.user.uid,createdAt:new Date,isOnline:!0}).then((function(){var n={firstName:e.firstName,lastName:e.lastName,email:e.email,uid:t.user.uid};localStorage.setItem("user",JSON.stringify(n)),console.log("you are succesfully logged in !!!"),a({type:"".concat(E,"_SUCCESS"),payload:{user:n}})})).catch((function(e){console.log(e),a({type:"".concat(E,"_FAILIER"),payload:{error:e}})}))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({firstName:r,lastName:h,email:O,password:w}))},className:"signUpForm"},c.a.createElement("div",{className:"formHeader"},"Creat account"),c.a.createElement("div",{class:"inputs"},c.a.createElement("input",{value:r,onChange:function(e){return o(e.target.value)},placeholder:"First Name"}),c.a.createElement("input",{value:h,onChange:function(e){return b(e.target.value)},placeholder:"Last Name"}),c.a.createElement("input",{value:O,onChange:function(e){return j(e.target.value)},placeholder:"Email"}),c.a.createElement("input",{value:w,onChange:function(e){return C(e.target.value)},placeholder:"Password"})),c.a.createElement("div",{className:"signupBtn"},c.a.createElement("button",null,"sign-up"))))))}),A=a(35),I=function(e){var t=e.component,a=Object(A.a)(e,["component"]);return c.a.createElement(s.b,Object.assign({},a,{component:function(e){return(localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null)?c.a.createElement(t,e):c.a.createElement(s.a,{to:"/login"})}}))};var U=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.auth}));return Object(n.useEffect)((function(){console.log(t.isAuthenticated),t.isAuthenticated||e(function(){var e=Object(p.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null,t(a?{type:"".concat(E,"_SUCCESS"),payload:{user:a}}:{type:"".concat(E,"_FAILIER"),payload:{error:"cannot find a user"}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),c.a.createElement("div",{className:"App"},c.a.createElement(i.a,null,c.a.createElement(I,{path:"/",exact:!0,component:N}),c.a.createElement(s.b,{path:"/login",component:w}),c.a.createElement(s.b,{path:"/signup",component:C})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var k=a(20),R={firstName:"",lastName:"",email:"",uid:"",isAuthenticated:!1,isAuthenticating:!1,error:null},x={users:[],conversations:[]},T=Object(k.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"".concat(E,"_REQUEST"):e=Object(O.a)(Object(O.a)({},e),{},{isAuthenticating:!0});break;case"".concat(E,"_SUCCESS"):e=Object(O.a)(Object(O.a)(Object(O.a)({},e),t.payload.user),{},{isAuthenticated:!0,isAuthenticating:!1});break;case"".concat(E,"_FAILIER"):e=Object(O.a)(Object(O.a)({},e),{},{error:t.payload.error,isAuthenticating:!1,isAuthenticated:!1});break;case"".concat(b,"_REQUEST"):break;case"".concat(b,"_SUCCESS"):e=Object(O.a)({},R);break;case"".concat(b,"_FAILIER"):e=Object(O.a)({},e)}return e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"".concat(g,"_REQUEST"):break;case"".concat(g,"_SUCCESS"):e=Object(O.a)(Object(O.a)({},e),{},{users:t.payload.users});break;case v:e=Object(O.a)(Object(O.a)({},e),{},{conversations:t.payload.conversations})}return e}}),L=a(34),F=Object(k.d)(T,Object(k.a)(L.a));h.a.initializeApp({apiKey:"AIzaSyD9Kz2yKA7cqVdnM3iml0VeC1bmBR-JddE",authDomain:"online-chating-app.firebaseapp.com",databaseURL:"https://online-chating-app.firebaseio.com",projectId:"online-chating-app",storageBucket:"online-chating-app.appspot.com",messagingSenderId:"748775564473",appId:"1:748775564473:web:590876040b64c4efdea768",measurementId:"G-7ER85TEJ19"}),window.store=F,o.a.render(c.a.createElement(l.a,{store:F},c.a.createElement(c.a.StrictMode,null,c.a.createElement(U,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.8c36e4b2.chunk.js.map